

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Models in convis.models &mdash; convis 0.6.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="convis 0.6.4 documentation" href="index.html"/>
        <link rel="up" title="The API: Convis classes and modules" href="docs.html"/>
        <link rel="next" title="VirtualRetina-like Simulator" href="docs_retina.html"/>
        <link rel="prev" title="Filters convis.filters" href="docs_filters.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> convis
          

          
          </a>

          
            
            
              <div class="version">
                0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="filters.html">Filters and Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_basics.html">PyTorch Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch_basics.html#pytorch-extensions-in-convis">PyTorch Extensions in Convis</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Models</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="docs.html">The API: Convis classes and modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="docs_filters.html">Filters <cite>convis.filters</cite></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Models in <cite>convis.models</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#convis-models">Convis Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#combinators">Combinators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linear-nonlinear-models">Linear-Nonlinear Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convolution-model">Convolution Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-convis.layers">Finding all Layers in one submodules <cite>convis.layers</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_retina.html">VirtualRetina-like Simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_streams.html">Streams <cite>convis.streams</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_optimizer.html">Optimizers <cite>convis.optimizer</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs_tests.html">Automatic Tests <cite>convis.tests</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html#module-convis.base">Base classes <cite>convis.base</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html#variables-convis-variables">Variables <cite>convis.variables</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html#module-convis.utils">Utilitary methods <cite>convis.utils</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html#sample-data-convis-samples">Sample Data <cite>convis.samples</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="docs.html#module-convis.variable_describe">Methods to describe objects <cite>convis.variable_describe</cite></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">convis</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="docs.html">The API: Convis classes and modules</a> &raquo;</li>
        
      <li>Models in <cite>convis.models</cite></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/docs_models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-convis.models">
<span id="models-in-convis-models"></span><span id="doc-models"></span><h1>Models in <cite>convis.models</cite><a class="headerlink" href="#module-convis.models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="convis-models">
<h2>Convis Models<a class="headerlink" href="#convis-models" title="Permalink to this headline">¶</a></h2>
<p>These models are ready to run.</p>
<dl class="class">
<dt id="convis.models.List">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">List</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.List" title="Permalink to this definition">¶</a></dt>
<dd><p>A sequential list of Layers that registers its items as submodules and provides tab-completable names with a prefix (by default ‘<a href="#id4"><span class="problematic" id="id5">layer_</span></a>’).</p>
<p>The list provides a forward function that sequentially
applies each module in the list.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.make_parallel_sequential_model" title="convis.models.make_parallel_sequential_model"><code class="xref py py-obj docutils literal"><span class="pre">make_parallel_sequential_model</span></code></a>, <a class="reference internal" href="#convis.models.make_sequential_parallel_model" title="convis.models.make_sequential_parallel_model"><code class="xref py py-obj docutils literal"><span class="pre">make_sequential_parallel_model</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">l</span><span class="o">.</span><span class="n">layer_2</span>
<span class="go">Conv3d (1, 1, kernel_size=(1, 10, 10), stride=(1, 1, 1), bias=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_input</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_gratings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">some_input</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="convis.models.List.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>module</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List.append"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.List.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends a module to the end of the list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the list itself</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="convis.models.List.extend">
<code class="descname">extend</code><span class="sig-paren">(</span><em>modules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List.extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.List.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends the list with modules from a Python iterable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the list itself</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="convis.models.Dict">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Dict</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#Dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.Dict" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of Layers that registers its items as submodules
and provides tab-completable names  of unnamed Layers 
with a prefix (by default ‘<a href="#id6"><span class="problematic" id="id7">layer_</span></a>’).</p>
<p>The dict provides a forward function that sequentially
applies each module in the list <em>in insertion order</em>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">l</span><span class="o">.</span><span class="n">layer_2</span>
<span class="go">Conv3d (1, 1, kernel_size=(1, 10, 10), stride=(1, 1, 1), bias=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_input</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_gratings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">some_input</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="convis.models.Sequential">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Sequential</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#Sequential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.Sequential" title="Permalink to this definition">¶</a></dt>
<dd><p>A Model that executes Layers sequentially,
passing the output of one as the input of the next.</p>
<p>This class inherits from <a class="reference external" href="https://pytorch.org/docs/0.3.0/nn.html#torch.nn.Sequential" title="(in PyTorch vmaster (0.3.0.post4 ))"><code class="xref py py-class docutils literal"><span class="pre">torch.nn.Sequential</span></code></a> and offers
the same mechanism for enumerating the provided Layers.
The <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> class will give modules names starting
with ‘<a href="#id8"><span class="problematic" id="id9">layer_</span></a>’ to make them tab-completable and offers the
a similar forward function to compute layers sequentially.</p>
<p>Using <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> is recommended over <a class="reference internal" href="#convis.models.Sequential" title="convis.models.Sequential"><code class="xref py py-class docutils literal"><span class="pre">Sequential</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-obj docutils literal"><span class="pre">List</span></code></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="convis.models.Parallel">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Parallel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#Parallel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.Parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>A container to execute layers in parallel.
Modules will be added to it in the order they are passed in the constructor.
Alternatively, an ordered dict of modules can also be passed in.</p>
<p>Using <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> with <cite>mode=’parallel’</cite> is recommended over 
<a class="reference internal" href="#convis.models.Parallel" title="convis.models.Parallel"><code class="xref py py-class docutils literal"><span class="pre">Parallel</span></code></a> if the names of the modules are not relevant.</p>
<p>Providing an argument <cite>sum</cite> will change how the outputs will be
combined. This can be a string (‘cat’ for concatenation on axis 0 (batch channel),
‘cat_1’ for concatenating at axis 1 (color channel),
‘cat_2’ for concatenating at time channel, ‘cat_2’ or ‘cat_3’ for concatenating in space,
‘sum’ for total sum,’sum_0’ for summing over axis 0, etc.)</p>
<p class="rubric">Examples</p>
<p>To make it easier to understand, here is a small example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Example of using Parallel</span>
<span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span>
        <span class="n">conv1</span><span class="p">,</span>
        <span class="n">conv2</span><span class="p">,</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="s1">&#39;cat_1&#39;</span>
    <span class="p">)</span> <span class="c1"># concatenates the output at dimension 1</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span>
        <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span> <span class="c1"># concatenates and sums the input at dimension 0</span>
    <span class="c1"># all other output dimensions MUST be the same!</span>

<span class="c1"># Example of using Parallel with OrderedDict</span>
<span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
          <span class="p">(</span><span class="s1">&#39;conv1&#39;</span><span class="p">,</span> <span class="n">conv1</span><span class="p">),</span>
          <span class="p">(</span><span class="s1">&#39;relu1&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()),</span>
          <span class="p">(</span><span class="s1">&#39;conv2&#39;</span><span class="p">,</span> <span class="n">conv2</span><span class="p">),</span>
          <span class="p">(</span><span class="s1">&#39;relu2&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="p">]),</span> <span class="nb">sum</span> <span class="o">=</span> <span class="s1">&#39;sum_0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="convis.models.make_sequential_parallel_model">
<code class="descclassname">convis.models.</code><code class="descname">make_sequential_parallel_model</code><span class="sig-paren">(</span><em>list_of_layers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#make_sequential_parallel_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.make_sequential_parallel_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an alternating sequential/parallel model starting with a sequential layer.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-obj docutils literal"><span class="pre">List</span></code></a>, <a class="reference internal" href="#convis.models.make_sequential_parallel_model" title="convis.models.make_sequential_parallel_model"><code class="xref py py-obj docutils literal"><span class="pre">make_sequential_parallel_model</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="convis.models.make_parallel_sequential_model">
<code class="descclassname">convis.models.</code><code class="descname">make_parallel_sequential_model</code><span class="sig-paren">(</span><em>list_of_layers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#make_parallel_sequential_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.make_parallel_sequential_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an alternating sequential/parallel model starting with a parallel layer.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-obj docutils literal"><span class="pre">List</span></code></a>, <a class="reference internal" href="#convis.models.make_parallel_sequential_model" title="convis.models.make_parallel_sequential_model"><code class="xref py py-obj docutils literal"><span class="pre">make_parallel_sequential_model</span></code></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="convis.models.LNCascade">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNCascade</code><span class="sig-paren">(</span><em>n=0</em>, <em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>autopad=True</em>, <em>nonlinearity=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNCascade"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.LNCascade" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear-nonlinear cascade model with a variable number of convolution filters.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<p>For each layer, a custom non-linearity can be set. If no non-linearity is set
for a specific layer, the default nonlinearity is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n (int):</strong></p>
<blockquote>
<div><p>number of Conv3d layers added when initialized (by default no layers are added)</p>
</div></blockquote>
<p><strong>kernel_dim (int tuple of time,x,y):</strong></p>
<blockquote>
<div><p>the default dimensions of the convolution filter weights</p>
</div></blockquote>
<p><strong>nonlinearity (Layer, torch.nn.Module or function):</strong></p>
<blockquote class="last">
<div><p>the default nonlinearity to use (defaults to a rectification)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.LN" title="convis.models.LN"><code class="xref py py-obj docutils literal"><span class="pre">LN</span></code></a>, <a class="reference internal" href="#convis.models.LNLN" title="convis.models.LNLN"><code class="xref py py-obj docutils literal"><span class="pre">LNLN</span></code></a>, <a class="reference internal" href="#convis.models.LNFDLNF" title="convis.models.LNFDLNF"><code class="xref py py-obj docutils literal"><span class="pre">LNFDLNF</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">LNCascade</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nonlinearity</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
<span class="go">        # the default nonlinearity sets a </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">nonlinearities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">NLRectifySquare</span><span class="p">()</span>  <span class="c1"># setting a custom non-linearity for this layer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">linearities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1"># no linear filter for this stage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">SmoothConv</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># None uses the default nonlinearity, *not* the identity!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">RF</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="86%" />
<col width="14%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>linearities (convis.List): list of linear layers</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>nonlinearities (convis.List): list of non-linear layers</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.L">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">L</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.L" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear model with a convolution filter.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.RF">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">RF</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#RF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.RF" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear model with a receptive field filter.</p>
<p>Pads input automatically to produce output of the same length as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.LN">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LN</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.LN" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear-nonlinear model with a convolution filter.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.LNLN">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNLN</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNLN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.LNLN" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear-nonlinear cascade model with two convolution filters.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.LNFDLNF">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNFDLNF</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>feedback_length=50</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNFDLNF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.LNFDLNF" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear-nonlinear cascade model with two convolution filters,
feedback for each layer and individual delays.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>feedback_length: int</strong></p>
<blockquote>
<div><p>Feedback is implemented as a temporal convolution filter,
<cite>feedback_length</cite> is the maximal possible
delay.</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="convis.models.Retina">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Retina</code><span class="sig-paren">(</span><em>opl=True</em>, <em>bipolar=True</em>, <em>gang=True</em>, <em>spikes=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/retina.html#Retina"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.Retina" title="Permalink to this definition">¶</a></dt>
<dd><p>A retinal ganglion cell model comparable to VirtualRetina <a class="reference internal" href="#wohrer200901" id="id1">[Wohrer200901]</a>.</p>
<table class="docutils citation" frame="void" id="wohrer200901" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[Wohrer200901]</a></td><td>Wohrer, A., &amp; Kornprobst, P. (2009).
Virtual Retina: a biological retina model and simulator, with contrast gain control.
Journal of Computational Neuroscience, 26(2), 219-49. <a class="reference external" href="http://doi.org/10.1007/s10827-008-0108-4">http://doi.org/10.1007/s10827-008-0108-4</a></td></tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="docs.html#convis.base.Layer" title="convis.base.Layer"><code class="xref py py-obj docutils literal"><span class="pre">convis.base.Layer</span></code></a></dt>
<dd>The Layer base class, providing chunking and optimization</dd>
<dt><a class="reference internal" href="docs_retina.html#convis.filters.retina.OPL" title="convis.filters.retina.OPL"><code class="xref py py-obj docutils literal"><span class="pre">convis.filters.retina.OPL</span></code></a></dt>
<dd>The outer plexiform layer performs luminance to contrast conversion</dd>
<dt><a class="reference internal" href="docs_retina.html#convis.filters.retina.Bipolar" title="convis.filters.retina.Bipolar"><code class="xref py py-obj docutils literal"><span class="pre">convis.filters.retina.Bipolar</span></code></a></dt>
<dd>provides contrast gain control</dd>
<dt><a class="reference internal" href="docs_retina.html#convis.filters.retina.GanglionInput" title="convis.filters.retina.GanglionInput"><code class="xref py py-obj docutils literal"><span class="pre">convis.filters.retina.GanglionInput</span></code></a></dt>
<dd>provides a static non-linearity and a last spatial integration</dd>
<dt><a class="reference internal" href="docs_retina.html#convis.filters.retina.GanglionSpiking" title="convis.filters.retina.GanglionSpiking"><code class="xref py py-obj docutils literal"><span class="pre">convis.filters.retina.GanglionSpiking</span></code></a></dt>
<dd>creates spikes from an input current</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">convis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pylab</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">retina</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">retina</span><span class="o">.</span><span class="n">Retina</span><span class="p">()</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_grating</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">inp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">inp</span><span class="p">[:</span><span class="mi">1000</span><span class="p">],</span><span class="mf">2.0</span><span class="o">*</span><span class="n">inp</span><span class="p">[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1500</span><span class="p">],</span><span class="n">inp</span><span class="p">[</span><span class="mi">1500</span><span class="p">:</span><span class="mi">2000</span><span class="p">]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">o_init</span> <span class="o">=</span> <span class="n">retina</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">retina</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="mi">500</span><span class="p">:],</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">convis</span><span class="o">.</span><span class="n">plot_5d_time</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># plots the mean activity over time</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">retina</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">retina</span><span class="o">.</span><span class="n">Retina</span><span class="p">(</span><span class="n">opl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">bipolar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">gang</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">spikes</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">o_init</span> <span class="o">=</span> <span class="n">retina</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">[:</span><span class="mi">500</span><span class="p">],</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">retina</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">inp</span><span class="p">[</span><span class="mi">500</span><span class="p">:],</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">convis</span><span class="o">.</span><span class="n">plot_5d_time</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># plots the mean activity over time</span>
<span class="n">convis</span><span class="o">.</span><span class="n">plot_5d_time</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1"># plots a line for each pixel</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//docs_models-1.py">Source code</a>)</p>
<div class="figure" id="id2">
<img alt="_images/docs_models-1_00.png" src="_images/docs_models-1_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//docs_models-1_00.png">png</a>, <a class="reference external" href=".//docs_models-1_00.hires.png">hires.png</a>, <a class="reference external" href=".//docs_models-1_00.pdf">pdf</a>)</span></p>
</div>
<div class="figure" id="id3">
<img alt="_images/docs_models-1_01.png" src="_images/docs_models-1_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href=".//docs_models-1_01.png">png</a>, <a class="reference external" href=".//docs_models-1_01.hires.png">hires.png</a>, <a class="reference external" href=".//docs_models-1_01.pdf">pdf</a>)</span></p>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>opl</strong></td>
<td>(Layer (convis.filters.retina.OPL))</td>
</tr>
<tr class="row-even"><td><strong>bipolar</strong></td>
<td>(Layer (convis.filters.retina.Bipolar))</td>
</tr>
<tr class="row-odd"><td><strong>gang_0_input</strong></td>
<td>(Layer (convis.filters.retina.GanglionInput))</td>
</tr>
<tr class="row-even"><td><strong>gang_0_spikes</strong></td>
<td>(Layer (convis.filters.retina.GanglionSpiking))</td>
</tr>
<tr class="row-odd"><td><strong>gang_1_input</strong></td>
<td>(Layer (convis.filters.retina.GanglionInput))</td>
</tr>
<tr class="row-even"><td><strong>gang_1_spikes</strong></td>
<td>(Layer (convis.filters.retina.GanglionSpiking))</td>
</tr>
<tr class="row-odd"><td><strong>_timing</strong></td>
<td>(list of tuples) timing information of the last run (last chunk) Each entry is a tuple of (function that was executed, number of seconds it took to execute)</td>
</tr>
<tr class="row-even"><td><strong>keep_timing_info</strong></td>
<td>(bool) whether to store all timing information in a list</td>
</tr>
<tr class="row-odd"><td><strong>timing_info</strong></td>
<td>(list) stores timing information of all runs if <cite>keep_timing_info</cite> is True.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="convis.models.LNFDSNF">
<code class="descclassname">convis.models.</code><code class="descname">LNFDSNF</code><a class="headerlink" href="#convis.models.LNFDSNF" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#convis.models.LNFDLNF" title="convis.models.LNFDLNF"><code class="xref py py-class docutils literal"><span class="pre">LNFDLNF</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="convis.models.McIntosh">
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">McIntosh</code><span class="sig-paren">(</span><em>filter_size=(10</em>, <em>5</em>, <em>5)</em>, <em>random_init=True</em>, <em>out_channels=1</em>, <em>filter_2_size=(1</em>, <em>1</em>, <em>1)</em>, <em>layer1_channels=8</em>, <em>layer2_channels=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#McIntosh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#convis.models.McIntosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolutional Retina Model</p>
<p>Contains two convolutional layers and one readout layer.</p>
<p>The first convolutional layer has 8 channels.
The second convolutional layer has 16 channels.
The readout is a linear combination over all space
and all channels of layer 2, resulting in <cite>out_channels</cite>
many output channels.</p>
<p>To set the weights individually:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">McIntosh</span><span class="p">(</span><span class="n">out_channels</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># mapping from 1 to 8 channels</span>
<span class="n">m</span><span class="o">.</span><span class="n">layer2</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span> <span class="c1"># mapping from 8 to 16 channels</span>
<span class="c1"># the readout needs some number of outputs</span>
<span class="c1"># and 16 x the number of pixels of the image as inputs</span>
<span class="n">m</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">16</span><span class="o">*</span><span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># plotting the parameters:</span>
<span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>[1] Mcintosh, L. T., Maheswaranathan, N., Nayebi, A., Ganguli, S., &amp; Baccus, S. A. (2016).
Deep Learning Models of the Retinal Response to Natural Scenes.
Advances in Neural Information Processing Systems 29 (NIPS), (Nips), 1-9.
Also: arXiv:1702.01825 [q-bio.NC]</p>
</dd></dl>

</div>
<p>Models are essentially the same as filters: they are both
classes that inherit most of their capabilities from <code class="xref py py-class docutils literal"><span class="pre">Layer</span></code>.
The split into two submodules is an effort to sort them by
complexity / generalizability. Eg. all filters can be combined into
more complex models (combining models does not always make sense)
and all models are ready to “do things”, which is not the case for eg.
the <code class="xref py py-class docutils literal"><span class="pre">TimePadding</span></code> filter.</p>
<p>If you feel the distinction is unnecessary, or you came up with a better
way to separate Layers into submodules, let me know by <a class="reference external" href="https://github.com/jahuth/convis/labels/enhancement">submitting a github issue!</a></p>
<div class="section" id="combinators">
<h2>Combinators<a class="headerlink" href="#combinators" title="Permalink to this headline">¶</a></h2>
<p>These classes can build simple models out of a sequence of Layers
by either combining them sequentially (the output of one layer
is the input of the next), or in parallel (all layers get the same
input).</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Sequential</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#Sequential"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A Model that executes Layers sequentially,
passing the output of one as the input of the next.</p>
<p>This class inherits from <a class="reference external" href="https://pytorch.org/docs/0.3.0/nn.html#torch.nn.Sequential" title="(in PyTorch vmaster (0.3.0.post4 ))"><code class="xref py py-class docutils literal"><span class="pre">torch.nn.Sequential</span></code></a> and offers
the same mechanism for enumerating the provided Layers.
The <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> class will give modules names starting
with ‘<a href="#id10"><span class="problematic" id="id11">layer_</span></a>’ to make them tab-completable and offers the
a similar forward function to compute layers sequentially.</p>
<p>Using <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> is recommended over <a class="reference internal" href="#convis.models.Sequential" title="convis.models.Sequential"><code class="xref py py-class docutils literal"><span class="pre">Sequential</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-obj docutils literal"><span class="pre">List</span></code></a></p>
</div>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">List</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A sequential list of Layers that registers its items as submodules and provides tab-completable names with a prefix (by default ‘<a href="#id12"><span class="problematic" id="id13">layer_</span></a>’).</p>
<p>The list provides a forward function that sequentially
applies each module in the list.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.make_parallel_sequential_model" title="convis.models.make_parallel_sequential_model"><code class="xref py py-obj docutils literal"><span class="pre">make_parallel_sequential_model</span></code></a>, <a class="reference internal" href="#convis.models.make_sequential_parallel_model" title="convis.models.make_sequential_parallel_model"><code class="xref py py-obj docutils literal"><span class="pre">make_sequential_parallel_model</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">List</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">l</span><span class="o">.</span><span class="n">layer_2</span>
<span class="go">Conv3d (1, 1, kernel_size=(1, 10, 10), stride=(1, 1, 1), bias=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">some_input</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">moving_gratings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">some_input</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt>
<code class="descname">append</code><span class="sig-paren">(</span><em>module</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List.append"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Appends a module to the end of the list.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the list itself</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">extend</code><span class="sig-paren">(</span><em>modules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#List.extend"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Extends the list with modules from a Python iterable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the list itself</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">Parallel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#Parallel"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A container to execute layers in parallel.
Modules will be added to it in the order they are passed in the constructor.
Alternatively, an ordered dict of modules can also be passed in.</p>
<p>Using <a class="reference internal" href="#convis.models.List" title="convis.models.List"><code class="xref py py-class docutils literal"><span class="pre">List</span></code></a> with <cite>mode=’parallel’</cite> is recommended over 
<a class="reference internal" href="#convis.models.Parallel" title="convis.models.Parallel"><code class="xref py py-class docutils literal"><span class="pre">Parallel</span></code></a> if the names of the modules are not relevant.</p>
<p>Providing an argument <cite>sum</cite> will change how the outputs will be
combined. This can be a string (‘cat’ for concatenation on axis 0 (batch channel),
‘cat_1’ for concatenating at axis 1 (color channel),
‘cat_2’ for concatenating at time channel, ‘cat_2’ or ‘cat_3’ for concatenating in space,
‘sum’ for total sum,’sum_0’ for summing over axis 0, etc.)</p>
<p class="rubric">Examples</p>
<p>To make it easier to understand, here is a small example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Example of using Parallel</span>
<span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span>
        <span class="n">conv1</span><span class="p">,</span>
        <span class="n">conv2</span><span class="p">,</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="s1">&#39;cat_1&#39;</span>
    <span class="p">)</span> <span class="c1"># concatenates the output at dimension 1</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span>
        <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">Sum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="p">)</span> <span class="c1"># concatenates and sums the input at dimension 0</span>
    <span class="c1"># all other output dimensions MUST be the same!</span>

<span class="c1"># Example of using Parallel with OrderedDict</span>
<span class="n">conv1</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">conv2</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">time_pad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parallel</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
          <span class="p">(</span><span class="s1">&#39;conv1&#39;</span><span class="p">,</span> <span class="n">conv1</span><span class="p">),</span>
          <span class="p">(</span><span class="s1">&#39;relu1&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()),</span>
          <span class="p">(</span><span class="s1">&#39;conv2&#39;</span><span class="p">,</span> <span class="n">conv2</span><span class="p">),</span>
          <span class="p">(</span><span class="s1">&#39;relu2&#39;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="p">]),</span> <span class="nb">sum</span> <span class="o">=</span> <span class="s1">&#39;sum_0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="linear-nonlinear-models">
<h2>Linear-Nonlinear Models<a class="headerlink" href="#linear-nonlinear-models" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">L</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#L"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A linear model with a convolution filter.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LN</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LN"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A linear-nonlinear model with a convolution filter.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNCascade</code><span class="sig-paren">(</span><em>n=0</em>, <em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>autopad=True</em>, <em>nonlinearity=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNCascade"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A linear-nonlinear cascade model with a variable number of convolution filters.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<p>For each layer, a custom non-linearity can be set. If no non-linearity is set
for a specific layer, the default nonlinearity is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n (int):</strong></p>
<blockquote>
<div><p>number of Conv3d layers added when initialized (by default no layers are added)</p>
</div></blockquote>
<p><strong>kernel_dim (int tuple of time,x,y):</strong></p>
<blockquote>
<div><p>the default dimensions of the convolution filter weights</p>
</div></blockquote>
<p><strong>nonlinearity (Layer, torch.nn.Module or function):</strong></p>
<blockquote class="last">
<div><p>the default nonlinearity to use (defaults to a rectification)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#convis.models.LN" title="convis.models.LN"><code class="xref py py-obj docutils literal"><span class="pre">LN</span></code></a>, <a class="reference internal" href="#convis.models.LNLN" title="convis.models.LNLN"><code class="xref py py-obj docutils literal"><span class="pre">LNLN</span></code></a>, <a class="reference internal" href="#convis.models.LNFDLNF" title="convis.models.LNFDLNF"><code class="xref py py-obj docutils literal"><span class="pre">LNFDLNF</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">LNCascade</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nonlinearity</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="nb">min</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mf">1.0</span><span class="p">))</span>
<span class="go">        # the default nonlinearity sets a </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">nonlinearities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">NLRectifySquare</span><span class="p">()</span>  <span class="c1"># setting a custom non-linearity for this layer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">linearities</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1"># no linear filter for this stage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">Conv3d</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">SmoothConv</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># None uses the default nonlinearity, *not* the identity!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">linear</span><span class="o">=</span><span class="n">convis</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">RF</span><span class="p">(),</span> <span class="n">nonlinear</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="86%" />
<col width="14%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>linearities (convis.List): list of linear layers</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><strong>nonlinearities (convis.List): list of non-linear layers</strong></td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNLN</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNLN"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A linear-nonlinear cascade model with two convolution filters.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">LNFDLNF</code><span class="sig-paren">(</span><em>kernel_dim=(1</em>, <em>1</em>, <em>1)</em>, <em>bias=False</em>, <em>feedback_length=50</em>, <em>population=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#LNFDLNF"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A linear-nonlinear cascade model with two convolution filters,
feedback for each layer and individual delays.</p>
<p>Pads input automatically to produce output of the same size as the input.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kernel_dim: tuple(int,int,int) or tuple(int,int,int,int,int)</strong></p>
<blockquote>
<div><p>Either the dimensions of a 3d kernel (time,x,y)
or a 5d kernel (out_channels,in_channels,time,x,y).</p>
</div></blockquote>
<p><strong>bias: bool</strong></p>
<blockquote>
<div><p>Whether or not to include a scalar bias parameter in
the linear filter</p>
</div></blockquote>
<p><strong>feedback_length: int</strong></p>
<blockquote>
<div><p>Feedback is implemented as a temporal convolution filter,
<cite>feedback_length</cite> is the maximal possible
delay.</p>
</div></blockquote>
<p><strong>population: bool</strong></p>
<blockquote class="last">
<div><p>If <cite>population</cite> is True, the last filter will be 
a convolution filter, creating a population of 
responses. If <cite>population</cite> is False, the last filter
will be a single receptive field, creating only
one output time series.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="convolution-model">
<h2>Convolution Model<a class="headerlink" href="#convolution-model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">convis.models.</code><code class="descname">McIntosh</code><span class="sig-paren">(</span><em>filter_size=(10</em>, <em>5</em>, <em>5)</em>, <em>random_init=True</em>, <em>out_channels=1</em>, <em>filter_2_size=(1</em>, <em>1</em>, <em>1)</em>, <em>layer1_channels=8</em>, <em>layer2_channels=16</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/convis/models.html#McIntosh"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Convolutional Retina Model</p>
<p>Contains two convolutional layers and one readout layer.</p>
<p>The first convolutional layer has 8 channels.
The second convolutional layer has 16 channels.
The readout is a linear combination over all space
and all channels of layer 2, resulting in <cite>out_channels</cite>
many output channels.</p>
<p>To set the weights individually:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">convis</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">McIntosh</span><span class="p">(</span><span class="n">out_channels</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">layer1</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># mapping from 1 to 8 channels</span>
<span class="n">m</span><span class="o">.</span><span class="n">layer2</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">))</span> <span class="c1"># mapping from 8 to 16 channels</span>
<span class="c1"># the readout needs some number of outputs</span>
<span class="c1"># and 16 x the number of pixels of the image as inputs</span>
<span class="n">m</span><span class="o">.</span><span class="n">readout</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">16</span><span class="o">*</span><span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="nb">input</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># plotting the parameters:</span>
<span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>[1] Mcintosh, L. T., Maheswaranathan, N., Nayebi, A., Ganguli, S., &amp; Baccus, S. A. (2016).
Deep Learning Models of the Retinal Response to Natural Scenes.
Advances in Neural Information Processing Systems 29 (NIPS), (Nips), 1-9.
Also: arXiv:1702.01825 [q-bio.NC]</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-convis.layers">
<span id="finding-all-layers-in-one-submodules-convis-layers"></span><h1>Finding all Layers in one submodules <cite>convis.layers</cite><a class="headerlink" href="#module-convis.layers" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#module-convis.layers" title="convis.layers"><code class="xref py py-mod docutils literal"><span class="pre">convis.layers</span></code></a> now contains all <code class="xref py py-class docutils literal"><span class="pre">Layers</span></code>
from <a class="reference internal" href="docs_filters.html#module-convis.filters" title="convis.filters"><code class="xref py py-mod docutils literal"><span class="pre">convis.filters</span></code></a> and <a class="reference internal" href="#module-convis.models" title="convis.models"><code class="xref py py-mod docutils literal"><span class="pre">convis.models</span></code></a>. If you are
unsure whether something is only a “filter” or a already a “model”,
they can all be found in the same module now. Still, <a class="reference internal" href="docs_filters.html#module-convis.filters" title="convis.filters"><code class="xref py py-mod docutils literal"><span class="pre">convis.filters</span></code></a>
and <a class="reference internal" href="#module-convis.models" title="convis.models"><code class="xref py py-mod docutils literal"><span class="pre">convis.models</span></code></a> will continue to be available separately.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">convis</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">convis</span><span class="o">.</span><span class="n">layers</span><span class="p">))</span>
</pre></div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="docs_retina.html" class="btn btn-neutral float-right" title="VirtualRetina-like Simulator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="docs_filters.html" class="btn btn-neutral" title="Filters convis.filters" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Jacob Huth.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.6.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>